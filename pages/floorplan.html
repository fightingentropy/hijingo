<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Neko Box Floorplan</title>
    <link rel="stylesheet" href="../styles/floorplan.css" />
  </head>
  <body>
    <div class="floorplan">
      <div class="total-capacity">
        Total Capacity: <span id="capacity-number"></span>
      </div>
      <div class="current-occupancy">
        Current Occupancy: <span id="occupancy-number">0</span>
      </div>
      <div class="stage">STAGE</div>
      <div class="bar">BAR</div>
      <div class="entrance">ENTRANCE</div>

      <!-- Main tables will be added here dynamically -->

      <div class="walk-in-area">
        <div class="walk-in">
          <div class="walk-in-number">1</div>
          <div class="walk-in-circle">WALK IN</div>
          <div class="walk-in-number">2</div>
        </div>
        <div class="walk-in">
          <div class="walk-in-number">1</div>
          <div class="walk-in-circle">WALK IN</div>
          <div class="walk-in-number">2</div>
        </div>
      </div>

      <div class="neko-box-area">
        <div class="neko-box-label">THE NEKO BOX</div>
        <div class="neko-box-tables">
          <!-- Neko Box tables will be added here -->
        </div>
      </div>
    </div>

    <script>
      const defaultConfiguration = [
        { id: 11, top: "129.352px", left: "225.907px", seats: 16 },
        { id: 10, top: "174.724px", left: "357.853px", seats: 14 },
        { id: 5, top: "30%", left: "30%", seats: 28 },
        { id: 9, top: "431.956px", left: "359.913px", seats: 18 },
        { id: 6, top: "40%", left: "45%", seats: 8 },
        { id: 7, top: "409.236px", left: "522.068px", seats: 22 },
        { id: 8, top: "55%", left: "55%", seats: 16 },
        { id: 4, top: "169.841px", left: "666.692px", seats: 8 },
        { id: 3, top: "242.096px", left: "704.799px", seats: 12 },
        { id: 2, top: "287.096px", left: "786.799px", seats: 12 },
        {
          id: 1,
          top: "440.871px",
          left: "934.129px",
          seats: 14,
          vertical: true,
        },
      ];

      let tables = JSON.parse(JSON.stringify(defaultConfiguration)); // Create a deep copy

      const nekoBoxTables = [
        { id: 17, seats: 10 },
        { id: 18, seats: 10 },
        { id: 19, seats: 10 },
      ];

      function createTable(table) {
        const tableDiv = document.createElement("div");
        tableDiv.className = "table";
        tableDiv.id = `table-${table.id}`;
        if (table.vertical) {
          tableDiv.classList.add("table-vertical");
        }
        tableDiv.style.top = table.top;
        tableDiv.style.left = table.left;

        const tableContent = document.createElement("div");
        tableContent.className = "table-content";

        const seatsDiv = document.createElement("div");
        seatsDiv.className = "seats";

        const topRow = document.createElement("div");
        topRow.className = "seat-row";

        const midpoint = Math.ceil(table.seats / 2);

        // Top row (left to right)
        for (let i = midpoint + 1; i <= table.seats; i++) {
          const seatDiv = document.createElement("div");
          seatDiv.className = "seat";
          seatDiv.textContent = i;
          topRow.appendChild(seatDiv);
        }

        seatsDiv.appendChild(topRow);

        const labelDiv = document.createElement("div");
        labelDiv.className = "table-label";
        labelDiv.textContent = `TABLE ${table.id}`;

        const bottomRow = document.createElement("div");
        bottomRow.className = "seat-row";

        // Bottom row (right to left)
        for (let i = midpoint; i >= 1; i--) {
          const seatDiv = document.createElement("div");
          seatDiv.className = "seat";
          seatDiv.textContent = i;
          bottomRow.appendChild(seatDiv);
        }

        tableContent.appendChild(seatsDiv);
        tableContent.appendChild(labelDiv);
        tableContent.appendChild(bottomRow);
        tableDiv.appendChild(tableContent);

        document.querySelector(".floorplan").appendChild(tableDiv);
      }

      function createNekoBoxTable(table) {
        const tableDiv = document.createElement("div");
        tableDiv.className = "neko-box-table";

        const leftColumn = document.createElement("div");
        leftColumn.className = "table-column";
        const rightColumn = document.createElement("div");
        rightColumn.className = "table-column";

        // Update the loop to accommodate 10 seats
        for (let i = 10; i > 5; i--) {
          const seat = document.createElement("div");
          seat.className = "seat";
          seat.textContent = i;
          leftColumn.appendChild(seat);
        }

        const labelDiv = document.createElement("div");
        labelDiv.className = "table-label";
        labelDiv.textContent = `TABLE ${table.id}`;

        // Update the loop to accommodate 10 seats
        for (let i = 1; i <= 5; i++) {
          const seat = document.createElement("div");
          seat.className = "seat";
          seat.textContent = i;
          rightColumn.appendChild(seat);
        }

        tableDiv.appendChild(leftColumn);
        tableDiv.appendChild(labelDiv);
        tableDiv.appendChild(rightColumn);

        document.querySelector(".neko-box-tables").appendChild(tableDiv);
      }

      tables.forEach(createTable);
      nekoBoxTables.forEach(createNekoBoxTable);

      function calculateTotalCapacity() {
        return 202; // Fixed total capacity
      }

      // Update total capacity
      const totalCapacity = calculateTotalCapacity();
      document.getElementById("capacity-number").textContent = totalCapacity;

      let currentOccupancy = 0;

      function toggleSeat(event) {
        if (event.target.classList.contains("seat")) {
          if (event.target.classList.contains("occupied")) {
            // If the seat is already occupied, unmark it
            event.target.classList.remove("occupied");
            currentOccupancy--;
          } else {
            // If the seat is not occupied, mark it
            event.target.classList.add("occupied");
            currentOccupancy++;
          }
          document.getElementById("occupancy-number").textContent =
            currentOccupancy;
        }
      }

      document
        .querySelector(".floorplan")
        .addEventListener("click", toggleSeat);
    </script>
  </body>
</html>
